# 模拟退火
是基于Monte-Carlo迭代求解策略的一种**随机寻优算法**，其出发点是基于物理中固体物质的退火过程与一般组合优化问题之间的相似性。模拟退火算法从某一较高初温出发，伴随温度参数的不断下降，结合一定的概率突跳特性在解空间中随机寻找目标函数的全局最优解，即在局部最优解能概率性地跳出并最终趋于全局最优。

## 原理
这种方法在更新解时，如果新解比当前解更优则接受，否则基于Metropolis准则判断是否接受：
$$\begin{equation*}
    P=\begin{cases}
        1, E_{t+1}<E_{t}\\
        e^{\frac{-(E_{t+1}-E_{t})}{kT}}, E_{t+1}\ge E_t
    \end{cases}
\end{equation*}$$   
如果当前解是`x_t`，对应的目标函数值（系统能量）是`E_t`，对搜索点施加随机扰动得到`x_t+1`和`E_t+1`。系统会以上式中的P为概率用`x_t+1`替代`x_t`。

## 算法的具体流程
1. 令`T=T0`，表示开始退火的初始温度，随机产生一个初始解`x0`并计算对应的目标函数值`E0`
2. 令`T=kT`，`k`是一个0-1的数，表示温度下降的速率
3. 对当前解`xt`施加随机扰动，在其邻域内产生一个新解`x_t+1`并计算对应的目标函数值`E_t+1`
4. 按照上面的公式判断是否接受新解
5. 重复执行`L`次步骤3和4（即在该温度下多次迭代）
6. 判断温度是否达到终止水平，如果达到则算法结束，输出当前的`x_t`，否则返回步骤2（退火）

- 当`T`值不断减小时，跳出的概率越小，得到的解收敛
- 可以尝试多次选择初始点
- 类似于神经网络训练，可以取中间迭代次数的结果

## 调用方法
```python
from scipy.optimize import anneal

result = anneal(objective_function, initial_solution)
```

## 应用
- 可以进行超大规模集成电路的最优设计，如全局布线、布板、布局和逻辑最小化等等。
- 可以用来图像复原
- 应用于神经网络训练，跳出局部最优解
- 旅行商问题：一个商品推销员要去若干个城市推销商品，该推销员从一个城市出发，需要经过所有城市后，回到出发地。应如何选择行进路线，以使总的行程最短。
- 背包问题：给定n件物品，每一件物品有价值vi和重量wi，给定一个容量为W的箱子，要求用在不超过箱子容量的前提下，装入价值尽可能多的物品。

## 缺点
- 收敛慢，计算成本高
- 依赖于初始参数设置，需要多次改变参数
- 不能完全解决陷入局部最优解的问题

## 优点
- 有一定的跳出局部最优解能力
- 适用范围广，可以解决**连续优化、离散优化、组合优化问题**
- 实现简单

