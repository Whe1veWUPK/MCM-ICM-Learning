## 规划类

### 1. 线性规划

#### 1.1 线性规划模型及概念

1. 引例

生产甲乙机床，利润分别为4000和3000. 生产甲要A、B机器，加工时间分别为每台2h和每台1h；乙要A、B、C机器，加工时间均为1h。若每天可用于加工的机器时数分别为A 10h，B 8h，C 7h，为怎样生产甲乙机床各几台利润最大
- 问题分析
- 模型假设
- 模型建立
  总利润$z = 4x_1 + 3x_2$，目标函数：max z；$x_i$为决策变量；约束条件：$2x_1 + x_2 <= 10, \dots$

2. 建立模型一般步骤

- 分析问题，找出决策变量
- 依据条件，找出决策变量满足的线性不等式或等式约束，即为约束条件
- 根据问题目标，构造关于决策变量的线性函数，即为目标函数

3. 线性规划模型的形式

$$
max(min) z = c_1x_1+c_2x_2+\dots+c_nx_n \\
s.t. \begin{cases}
\sum_{j=1}^n a_{ij}x_j <=(or =, >=) b_i, & i = 1,2,\dots,m, \\
x_j >= 0, & j = 1,2,\dots,n. 
\end{cases}
$$

4. 线性规划问题的解的概念

可行解 -> 最优解
可行域

5. 灵敏度分析

- 如果参数$a_{ij},b_i,c_j$中的一个或多个发生了变化，现行最优方案会有什么变化？
- 将这些参数限制在什么范围内，原最优解仍是最优解？

#### 1.2 线性规划模型求解及应用

Matlab？ Python？

1. 线性规划的Matlab求解

- 基于求解器的求解方法
  线性规划的目标函数可以是求最大值，也可以是求最小值，约束条件的不等号也可能是大于等于或小于等于。为了避免这种形式多样性，Matlab基于求解器的求解方法种规定线性规划的标准形式为
  $$
  \underset {x}{min} f^Tx, \\
  s.t. \begin{cases}
    A \cdot x <= b, \\
    Aeq \cdot x = beq, \\
    lb <= x <= ub.
  \end{cases}
  $$
  式中：f,x,b,beq,lb,ub为列向量，其中为价值向量，b为资源向量；A，Aeq分别为不等式约束和等式约束对应的矩阵。
  Matlab基于求解器的求解线性规划函数调用格式为
  [x, fval] = linprog(f, A, b)
  [x, fval] = linprog(f, A, b, Aeq, beq)
  [x, fval] = linprog(f, A, b, Aeq, beq, lb, ub)
- 基于问题的求解方法
  首先需要用变量和表达式构造优化问题，然后用solve函数求解

例子：上面那个例子。
基于求解器 Matlab程序：

```matlab
clc, clear
c = [4, 3]; b = [10; 8; 7];
a = [2, 1;, 1, 1; 0, 1]; lb = zeros(2,1);
[x, fval] = linprog(-c, a, b, [], [], lb) % 没有等号约束
y = -fval                                 % 目标函数为最大化
```

基于问题求解的Matlab程序：

```matlab
clc, clear
prob = optimproblem('ObjectiveSense','max')   % 目标函数最大化的优化问题
c = [4, 3]; b = [10; 8; 7];
a = [2, 1;, 1, 1; 0, 1];
x = optimvar('x',2,'LowerBound',0);           % 决策变量
prob.Objective = c'* x;                       % 目标函数
prob.Constraints.con = a * x <= b;            % 约束条件
[sol, fval, flag, out] = solve(prob)          % fval返回最优值
sol.x                                         % 显示决策变量的值
```

### 2. 0-1规划

例如背包问题，可被并入整数规划中进行学习。

### 3. 整数规划

1. 整数规划问题

- 整数线性规划模型及问题
  纯整数规划：全部决策变量必须取整数值
  混合整数规划：决策变量中有一部分必须取整数值，另一部可以不取整数值的整数规划模型
  0-1整数规划：决策变量只能取0或1的整数规划
  一般形式与线性规划差不多，但注意$x_i$取整数
  典型例子：背包问题，标准指派问题，旅行商问题
  1. 背包问题：一个旅行者外出旅行，携带一背包，装一些最有用的东西，共有n种物品供选择。已知每件物品的“使用价值”$c_j$和质量$a_j$，要求：1）最多携带物品质量为b千克；2）每件物品要么不带，要么只能整件携带.
  引进0-1变量
  $$
  x_i = \begin{cases}
    1, 携带第i种物品，\\
    0, 不携带第i种物品 \\
  \end{cases}
  i = 1,2,\dots,n.
  $$
  目标函数：$max \quad z = \sum^n_{i-1} c_ix_i.$
  约束条件：。。。
  2. 标准指派问题：某单位有n项任务，正好需要n个人取完成，由于每项任务的性质以及每个人的能力和专长不同，假设分配每个人仅完成一项任务。设$c_{ij}$表示分配第i个人取完成第j项任务的费用（时间等），则应如何指派，才能使完成任务的总费用最小？
  引入0-1变量
  $$
  x_i = \begin{cases}
    1, 若指派第i个人完成第j项任务，\\
    0, 若不指派第i个人完成第j项任务 \\
  \end{cases}
  i,j = 1,2,\dots,n.
  $$
  目标函数：$min \quad z = \sum^n_{i-1} \sum^n_{j-1} c_{ij}x_{ij}.$
  约束条件：。。。
  3. 旅行商问题。有一推销员，从城市$v_1$出发，要遍访城市$v_2,v_3,...,v_n$各一次，最后返回$v_1$。已知从$v_i$到$v_j$的旅费为$c_{ij}$，问他应按怎样的次序访问这些城市，才能使总旅费最少. 较复杂。。

- 非线性约束条件的线性化
  相互排斥的约束条件：引入0-1变量可以把一些特定的非线性约束条件进行线性化
  关于固定费用的问题：有些固定费用的问题不能用一般线性规划来描述，但可改变为混合整数规划来解决。

2. 整数规划模型求解

- 整数线性规划模型求解
  例：为了生产的需要，某工厂的一条生产线需要每天24h不间断运转，但是每天不同时段所需要的工人最低数量不同，具体输入如下所示。已知每名工人的连续工作时间为8小时。则该工厂应该为该生产线配备多少名工人，才能保证生产线的正常运转？
  $$
  \begin{array}{cccccc}
  班次 & 1 & 2 & 3 & 4 & 5 & 6 \\
  时间段 & 0:00-4:00 & 4:00-8:00 & 8:00-12:00 & 12:00-16:00 & 16:00-20:00 & 20:00~24:00 & \\
  工人数量 & 35 & 40 & 50 & 45 & 55 & 30 \\
  \end{array}
  $$
  分析：从降低经营成本的角度来看，为该生产线配备的工人数量越少，工厂所付出的工人薪资之和也就越低。因此，该问题需要确定在每个时间段工作的工人数量，使其既能满足生产线的生产需求，又能使得雇佣的工人总数最低。
  模型假设：1、每名工人每24h只能工作8h；2、每名工人只能在某个班次的初始时刻报道
  符号说明：设$x_i$表示在第i各班次报到的工人数量，i=1,2,...,6.
  得到的数学模型：
  $$
  min z = \sum_{i = 1}^6 x_i, \\
  s.t. \begin{cases}
    x_i+x_6 >= 35 \\
    x_1+x_2 >= 40 \\
    \dots \\
    x_5+x_6 >= 30 \\
    x_i >= 0 且为整数，i = 1,2,\dots,6.
  \end{cases}
  $$
  matlab 代码

  ```matlab
  clc, clear, prob = optimproblem;
  x = optimvar('x',6,'Type','integer','LowerBound',0);
  prob.Objective = sum(x);
  con = optimconstr(6);
  a = [35,40,50,45,55,30];
  con(1) = x(1)+x(6) >= 35;
  for i = 1 : 5
    con(i+1) = x(i) + x(i+1) >= a(i+1);
  end
  prob.Constraints.con = con;
  [sol, fval, flag] = solve(prob), sol.x
  ```

- 蒙特卡洛法
  例：非线性整数规划

  $$
  max z = x_1^2 + x_2^2 + 3x_3^2 +\dots \\
  s.t. \begin{cases}
    0 <= x_i <= 99, i = 1,2,\dots,5, \\
    x_1 + x_2 + x_3 + x_4 + x_5 <= 400, \\
    \dots, \\
    x_3 + x_4 + 5x_5 <= 200.
  \end{cases}
  $$

  应用蒙特卡洛法，随机采样$10^6$个点计算，便可找到满意解。

  ```matlab
  clc, clear
  $ rng('shuffle')
  rng(0)
  p0=0;n=10^6;tic
  for i=1 : n
    x = randi([0,99],1,5);
    [f,g]=mengte(x);
    if all(g <= 0)
      if p0 < f
        x0=x;p0=f;
      end
    end
  end
  x0,p0,toc
  function [f,g] = mengte(x);
  f = x(1)^2+x(2)^2+...;
  g = [sum(x) - 400x(1)+2*x(2)+...];
  end
  ```

### 目标规划

1. 目标规划的概念
  例子：工厂生产两种产品，有原材料，设备，利润等因素，同时原材料和设备还有拥有量这一要素。
  只用线性规划还不够，因为：1. 根据市场信息，产品I的销售量有下降的趋势，故考虑产品I的产量不大于产品II。 2. 超过计划供应的原材料，需要高价采购，使得成本增加 3. 尽可能地利用设备，但不希望加班 4. 应尽可能达到并超过计划利润指标56万元
  引入建立目标规划模型的概念：
    1. 正负偏差变量：设$f_i(i=1,2,...,l)$为第i个目标函数，它的正偏差变量$d_i^+=max\{f_i-d_i^0, 0\}$表示决策值超过目标值的部分，负偏差变量$d_i^-=-min\{f_i-d_i^0, 0\}$表示决策值未达到目标值的部分，这里$d_i^0$表示$f_i$的目标值。因决策值不可能既超过又未达到目标值，即恒有$d_i^+ \times d_i^- = 0$。
    2. 绝对（刚性）约束和目标约束：绝对约束是指必须严格满足的等式约束和不等式约束，如线性规划问题的所有约束条件，不能满足这些条件的解称为非可行解，所以它们是硬约束。目标约束是目标规划特有的，可把约束右端项看作要追求的目标值。在达到此目标值时允许发生正或负偏差，因此在这些约束中加入正、负偏差变量，它们是软约束。线性规划问题的目标函数，在给定目标值和加入正、负偏差变量后可变换为目标约束。
    3. 优先因子（优先等级）与权系数：一个规划问题常常又若干个目标。但决策者在要求达到这些目标时，是有主次或轻重缓急的。凡要求第一位达到的目标赋于优先因子P1，次位的目标赋于优先因子P2，....，并规定$$。表示Pk比Pk+1有更大的优先权。以此类推，在区别具有相同优先因子的两个目标的差别时，可分别赋于它们不同的权系数wj，这些都由决策者依具体情况而定。
    4. 目标规划的目标函数：目标规划的目标函数（准则函数）是按各目标约束的正、负偏差变量和赋于相应的优先因子而构造的。当每一目标值确定后，决策者的要求是尽可能缩小偏离目标值。因此目标规划的目标函数只能是所有偏差变量的加权和。其基本形式有三种。(1)第i个目标要求恰好达到目标值，即正负偏差变量都要尽可能地小，这时
    $$
    min w_i^- d_i^- + w_i^+ d_i^+
    $$
    (2)第i个目标要求不超过目标值，即允许达不到目标值，就是正偏差变量要尽可能地小，这时，
    $$
    min w_i^+ d_i^+
    $$
    (3)第i个目标要求超过目标值，即超过量不限，但必须是负偏差变量要尽可能地小，这时，
    $$
    min w_i^- d_i^-
    $$
    对每一个具体目标规划问题，可根据决策者地要求和赋于各目标地优先因子来构造目标函数。
  一般数学模型：
  设$x_j(j=1,2,...,n)$是目标规划的决策变量，共有m个约束是刚性约束，可能是等式约束，也可能是不等式约束。设有l个柔性目标约束,其目标约束的偏差为$d_i^+, d_i^-(i=1,2,...,l)$。设有q个优先级别，分别为$P_1,P_2,...,P_q$。在同一个优先级$P_k$中有不同的权重，分别记为$w_{ki}^+, w_{ki}^-(i=1,2,...,l)$。因此目标规划模型的一般数学表达式为 （课本P432页）

2. 求解目标规划的序贯算法
  核心是根据优先级的先后次序，将目标规划问题分解成一系列的单目标规划问题，再依次求解。
  。。好复杂。。看书！

### 非线性规划（未写完）

1. 非线性规划问题的数学模型
  记$\bm{x} = [x_1,x_2,\dots,x_n]^T$是n维欧几里得空间$R^n$中的一个点。$f(\bm{x})，g_i(\bm{x})，i=1,2,...,p$和$h_j(\bm{x})，j=1,2,...,q$是定义在$R^n$上的实值函数。
  若$f(\bm{x})，g_i(\bm{x})，i=1,2,...,p$和$h_j(\bm{x})，j=1,2,...,q$中至少有一个是$\bm{x}$的非线性函数，称如下形式的数学模型：

  $$
  min \quad f(x), \\
  s.t. \begin{cases}
  g_i(\bm{x}) <= 0, & i = 1,2,\dots,p, \\
  h_j(\bm{x}) = 0, & j = 1,2,\dots,q. 
  \end{cases}
  $$
  为非线性规划的一般形式
  对于求目标函数的最大值或约束条件为大于或等于0的情况，可通过取其相反数转化为上述一般形式。

2. 无约束非线性规划的求解

3. 有约束非线性规划的求解

4. 凸规划

。。别选这题

### 排队论
